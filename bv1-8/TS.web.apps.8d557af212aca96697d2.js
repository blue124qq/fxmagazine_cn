(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["TS.web.apps"],{"kG/F":function(e,a){(function(){TS.registerModule("web.apps",{onStart:function e(){n();var a=$(".apps_search_input");if(bowser.mobile)a.attr("placeholder",a.data("mobile-placeholder"));else{a.each((function(e,a){l($(a))}));d(a);a.removeAttr("disabled")}},showErrorAlert:function e(a){a||(a=null);var t=$("#apps_alert");t.removeClass("fade");t[0].offsetWidth;a&&t.find(".error_msg").text(a);t.toggleClass("hidden",false).addClass("fade")},hideErrorAlert:function e(){$("#apps_alert").toggleClass("hidden",true)}});var e=5;var a=$("#mobile_search");var t=a.find(".mobile_search_input");function n(){Ladda.bind(".ladda-button");$("body").on("click","[data-whitelist-resolution]",o);$(".apps_search_form").on("submit",(function(e){var a=$(this).find(".apps_search_input, .mobile_search_input");var t=$.trim(a.val());var n=a.data("search");n||(n="unknown_location");TS.interop.clog.track("OAUTH_TYPEAHEAD_SEARCH_SUBMIT",{query:t,search_input_location:n});t||e.preventDefault()}));$("body").on("change","select[data-url-switcher]",(function(){if(!this.value)return;window.location=this.value}));$(".apps_btn_revoke").on("click",(function(e){e.preventDefault();TS.generic_dialog.start({body:TS.interop.i18n.t("Are you sure you want to revoke this authorization?","apps")(),go_button_class:"btn_danger",go_button_text:TS.interop.i18n.t("Revoke","apps")(),onGo:function a(){var t=$(e.target).find("form");t.submit()}})}));$(".apps_btn_revoke_all").on("click",(function(e){e.preventDefault();var a=TS.interop.i18n.t("Are you sure you want to remove {app_name} from your entire workspace? Once removed, no members of {workspace_name} will be able to use this app.","apps","82215572390c8f66662dbfc214696999dc33e223")({app_name:TS.interop.i18n.safeString(_.escape(TS.boot_data.app_name)),workspace_name:TS.interop.i18n.safeString(_.escape(TS.boot_data.team_name))});var t=TS.interop.i18n.t("Remove this app for everyone?","apps","e963907dac5cd5c017869b4c96c18021c9bd058b")();TS.generic_dialog.start({title:t,body:a,go_button_class:"btn_danger",go_button_text:TS.interop.i18n.t("Remove App","apps")(),onGo:function a(){var t=$(e.target).find("form");t.submit()}})}));$("#mobile_search_open").on("click",p);$("#mobile_search_close").on("click",c);$("#page_contents").on("click",(function(e){if(a.hasClass("hidden"))return;$(e.target).closest("#mobile_search").length||c()}));$("#mobile_menu_open").on("click",(function(e){e.preventDefault();$("body").addClass("show_mobile_nav")}));$(".mobile_menu .close").on("click",(function(){$("body").removeClass("show_mobile_nav")}));$(".team_switcher.menu_launcher").on("click",(function(e){var a=$("#teams_list");TS.menu.startWithList(e,a,{close_on_click:true,menu_class:"avatar_menu",align_right:true})}));$('[data-js="js-toggle-categories"]').on("click",(function(){$('[data-js="js-categories-list"]').toggleClass("apps_categories_selector__list--show");$('[data-js="js-apps-header"]').toggleClass("hidden")}));TS.boot_data.feature_aaa_admin_apis&&$('[data-js="app_management_apps_toggle"]').click((function(){$(this).parent().siblings().addBack().toggleClass("hidden")}))}function o(e){e.preventDefault();var a=$(this);var t=a.data("app-id");var n=a.data("request-id");var o="1"==a.data("whitelist-resolution");var r="1"==a.data("is-integration");var p="1"==a.data("is-api-tester");if(o||bowser.mobile){s(o,t,n).catch((function(e){Ladda.stopAll();TS.error(e);TS.web.apps.showErrorAlert(TS.interop.i18n.t("Darn, the API call failed. Try again?","apps")())}));return}var c=a.data("app-name");var l=a.data("user-name");var d=parseInt(a.data("app-count"),10);isNaN(d)&&(d=0);i(c,l,d,n,r,p,(function(){TS.generic_dialog.startLadda();TS.generic_dialog.hideError();s(o,t,n,r).catch((function(){TS.generic_dialog.stopLadda();TS.generic_dialog.showError(TS.interop.i18n.t("Hmm, that didn\u2019t work. Try again?","apps")())}))}))}function i(e,a,t,n,o,i,s){var p=r(e,o,i);var c=i||o?TS.interop.i18n.t("Deny Request","apps")():TS.interop.i18n.t("Restrict App","apps")();TS.generic_dialog.start({title:p,body:TS.templates.apps_restrict_app_modal_body({app_name:e,config_count:t,is_api_tester:i,is_custom_integration:o,request_id:n,user_name:a}),ladda:true,show_go_button:true,show_cancel_button:true,go_button_text:c,go_button_class:"btn_danger",cancel_button_text:TS.interop.i18n.t("Cancel","apps")(),onGo:function e(){s&&s();return false}})}function r(e,a,t){if(t)return TS.interop.i18n.t("Deny API token request?","apps")();if(a){e||(e="Custom Integration");return TS.interop.i18n.t("Deny request for {app_name}?","apps")({app_name:TS.interop.i18n.safeString(_.escape(e))})}e||(e="app");return TS.interop.i18n.t("Restrict {app_name} for your workspace?","apps")({app_name:TS.interop.i18n.safeString(_.escape(e))})}function s(e,a,t){var n={app:a,resolution:e?"approved":"denied"};t&&(n.custom_request_id=t);return TS.interop.api.call("apps.whitelist.add",n).then((function(){TS.reload(false,"TS.web.apps._resolveWhitelistAction")}))}var p=function e(){a.removeClass("hidden");a.animate({opacity:1},150);t.focus()};var c=function e(){t.blur();a.animate({opacity:0},150,(function(){a.addClass("hidden")}))};function l(a){TS.ui.typeahead.bind(a,{asyncQuery:function a(t){var n={term:t,limit:e+1};return TS.interop.api.call("search.appDirectory",n).then((function(a){var t=_.get(a,"data.suggestions")||[];return{has_more_suggestions:t.length>e,suggestions:t.slice(0,e)}}))},onSelection:function e(t){if(t.$el[0]!=a[0])return;var n=$(t.$el[0]).data("search");n||(n="unknown_location");TS.interop.clog.track("OAUTH_TYPEAHEAD_SEARCH",{app_id:t.$selection.data("app-id"),app_name:t.$selection.data("app-name"),is_slack_owned:t.$selection.data("app-is-slack-owned"),search_term:a.val(),search_result_position:t.$selection.data("position"),search_input_location:n});var o=t.$selection.attr("href");o&&(window.location=o)},template:TS.templates.apps_typeahead})}function d(e){plastic.header_pin_sig.add((function(){if($("body").hasClass("apps_directory"))return;e.blur()}));plastic.header_unpin_sig.add((function(){if($("body").hasClass("apps_directory"))return;TS.ui.typeahead.hide(e)}))}})()}},[["kG/F","webpack.manifest"]]]);